>以下规范全面使用ES2015（旧称ES6）新语法，需要引擎支持，或者使用babel等工具进行转换。

部分规范参考[Airbnb的js规范](https://github.com/airbnb/javascript)。

### let和const

一句话，不会修改变量使用const，会修改变量使用let，禁用var。

### export和import

ES6终于在官方层面支持了JS的模块化语法，不同于AMD、CMD、UMD、commonjs等野鸡模块化语法，推荐使用官方版。

### 箭头函数

箭头函数和普通函数并并无太大差别，除了解决了函数在运行时存在this不确定的问题。

箭头函数在声明的时候就确定了this，而且不会在运行时改变。

多使用箭头函数总是好的，特别是一些使用短函数（lambda）的场景。

```javascript
const arr = [1, 2, 3].map(number => number * number);
```

当箭头函数只有一个参数时，省略圆括号；当函数体只有一行语句时，省略return（如果有）和花括号。

注意：箭头函数不能使用关键字`new`进行调用，因为箭头函数没有`[[Construct]]`方法。

箭头函数行为比较单一，不能改变this、不能使用new进行调用等，所以JS引擎一般也好优化些。

### class

需要类的地方使用`class`关键字进行声明，注意是小写，使用`extends`实现继承，不推荐继续使用原型链。

类成员函数只能使用简写语法，注意成员之间没有逗号。

类属性需在`constructor`进行声明和初始化，另外`static`目前只支持方法，不支持属性。

```javascript
class DN {
    play() {
        console.log('enjoy!');
    }
    // 暂不支持
    // static name = 'hldn';
    static get name() {
        return 'hldn';
    }
}
```

注意，在constructor方法里面使用this之前，需要先调用`super();`。

### 对象

和class类似，对象的函数属性也推荐使用简写语法。

其他属性当属性名和变量名一样的时候也使用简写，其实这是一种很常见的开发模式。

一句话，能简则简。

```javascript
const name = 'dn';
const DN = {
    name,
    play() {
        console.log('enjoy!');
    }
};
```

另外，为了排版上好看，将所有简写的属性放在对象的开头。

当需要动态属性名的时候，使用`computed property names`。

`computed property names`可以直接在对象字面量里使用。

```javascript
function getKey() {
    return String(Date.now());
}
const obj = {
    // computed property name
    // 方括号加上表达式
    [getKey()]: 'the key is a timestamp'
};
```

使用`...`语法复制或者合并对象。

```javascript
const obj1 = {a: 1, b: 2};
const obj2 = {b: 3, c: 4};

const obj3 = {...obj1};
// {a: 1, b: 2}
// 花括号不能忘了，数组的话不能忘了方括号
const obj4 = {...obj1, ...obj2};
// {a: 1, b: 3, c: 4}
```

数组也可以使用类似的语法。

### 解构赋值

解构赋值可以看做是对象简写的逆过程。

```javascript
const DN = {
    name,
    play() {
        console.log('enjoy!');
    }
};
const games = ['dn', 'ddz'];

const {name, play} = DN;
// 重命名
const {name, play: playGame} = DN;
// 使用默认值
const {name = 'hldn', play} = DN;
// 数组也一样
const [game1, game2] = games;
```

另外，再看看如何交换两个变量的值。

```javascript
let a = 1;
let b = 2;

console.log(a, b);
// 1, 2

// 和数组的解构赋值很像，但并不是一样的
[a, b] = [b, a];

console.log(a, b);
// 2, 1
```

### 默认参数

当函数参数需要默认值的时候，使用新的默认参数语法。

```javascript
function enterRoom(id = defaultID) {
    _enter(id);
}
```

注意，只有id是undefined的时候默认参数才会生效，其他空值（null、0等）并不会生效。

undefined可以是不传参数或者显式传`undefined`。

默认参数可以在函数参数的任何位置，并不一定要求在最后，不过如果不是末尾，在调用的时候要格外小心。

### 剩余参数

使用剩余参数替代`arguments`，并且不要再使用arguments了。

```javascript
function enterRoom(id, ...args) {
    // args是一个数组
    _enter(id)(...args);
}
```

剩余参数也是`...`语法，并且只能出现在函数参数的最后面，且只能使用一个。

和arguments总是反应总的参数个数不同，剩余参数的长度是真实反应剩余参数的个数。

剩余参数不能用在`setter`里，否则会报语法错误，其实正常也不会有这种使用场景。

箭头函数没有arguments变量，只能使用剩余参替代。

### 展开操作符

上面使用到的`...`叫做展开操作符，常用于复制、合并对象和数组，函数传参等。

作为函数传参的时候，展开操作符并没有位置要求。

```javascript
const arr = [-1, -2, -3];

Math.max(...arr, 0);
// 相同的效果
Math.max(0, ...arr);
```

### Promise

callback和Promise是两种异步的API风格，ES6开始正式支持了Promise，由于ES7的异步函数（`await`，`async`）是基于Promise的，建议需要异步处理的地方使用Promise。

```javascript
function sleep(time) {
    return new Promise(resolve => setTimeout(resolve, time));
}

async function doSomthing() {
    await sleep(1000);
    // do something
}
```

### 迭代器

迭代器可以使用`for...of`循环，相比数组进行迭代，迭代器有占用内存小的优势，因为迭代器的元素只有在需要时才会计算生成，不用像数组那样需要预先申请好内存。

### 尾递归

ES6对尾调用进行了优化，尾调用通常出现在尾递归中，使用尾递归需要进行优化。
